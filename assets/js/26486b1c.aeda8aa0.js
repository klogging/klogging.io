"use strict";(self.webpackChunkklogging_io=self.webpackChunkklogging_io||[]).push([[8099],{16:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>g,contentTitle:()=>l,default:()=>d,frontMatter:()=>t,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"java/spring-boot","title":"Klogging with Spring Boot","description":"Klogging works really well with Spring Boot, especially in Kotlin code.","source":"@site/docs/java/spring-boot.md","sourceDirName":"java","slug":"/java/spring-boot","permalink":"/docs/java/spring-boot","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":30,"frontMatter":{"sidebar_position":30},"sidebar":"tutorialSidebar","previous":{"title":"Using Klogging with SLF4J","permalink":"/docs/java/slf4j"},"next":{"title":"Ktor","permalink":"/docs/ktor/"}}');var r=o(4848),s=o(8453);const t={sidebar_position:30},l="Klogging with Spring Boot",g={},a=[{value:"Using Klogging in Spring Boot",id:"using-klogging-in-spring-boot",level:2},{value:"In Kotlin code",id:"in-kotlin-code",level:3},{value:"Gradle setup",id:"gradle-setup",level:2},{value:"Maven setup",id:"maven-setup",level:2},{value:"Configure Klogging",id:"configure-klogging",level:2}];function c(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"klogging-with-spring-boot",children:"Klogging with Spring Boot"})}),"\n",(0,r.jsx)(e.p,{children:"Klogging works really well with Spring Boot, especially in Kotlin code."}),"\n",(0,r.jsxs)(e.p,{children:["You can set Klogging as the logging framework of a Spring Boot application.\nThe ",(0,r.jsx)(e.a,{href:"https://github.com/klogging/klogging/klogging-spring-boot-starter",children:"Klogging spring boot starter"}),"\nmakes it simple. See ",(0,r.jsx)(e.a,{href:"#gradle-setup",children:"Gradle setup"})," below for details."]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://central.sonatype.com/search?smo=true&q=io.klogging%3Aklogging-spring-boot-starter",children:(0,r.jsx)(e.img,{src:"https://img.shields.io/maven-central/v/io.klogging/klogging-spring-boot-starter.svg?label=maven%20central",alt:"Maven Central"})})}),"\n",(0,r.jsx)(e.h2,{id:"using-klogging-in-spring-boot",children:"Using Klogging in Spring Boot"}),"\n",(0,r.jsx)(e.p,{children:"Firstly, all Spring libraries log via SLF4J and log events will be processed by Klogging."}),"\n",(0,r.jsxs)(e.p,{children:["Similarly, any existing application code that uses SLF4J will also have logs processed by Klogging.\nYou can also create structured log events with SLF4J.\nSee ",(0,r.jsx)(e.a,{href:"/docs/java/slf4j#including-values-in-messages",children:"Including values in messages"})," for more information."]}),"\n",(0,r.jsx)(e.h3,{id:"in-kotlin-code",children:"In Kotlin code"}),"\n",(0,r.jsxs)(e.p,{children:["Spring Boot has first-class support for Kotlin, including coroutines. This means you can\nuse ",(0,r.jsx)(e.code,{children:"suspend"})," functions and all of Klogging\u2019s features for creating structured log events. A simple\nexample might include:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-kotlin",children:'@RestController\nclass HelloController(\n    val helloService: HelloService,\n) : Klogging {\n\n    @GetMapping("/hello")\n    suspend fun hello(): String {\n        return withLogContext("runId" to UUID.randomUUID()) {\n            logger.info("controller")\n            "Hello ${service.randomName()}"\n        }\n    }\n}\n\n@Component\nclass HelloService() : Klogging {\n    suspend fun randomName(): String {\n        return NAME_LIST.random().also {\n            logger.info("service returning {name}", it)\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"Klogging will produce contextual, structured logs like this:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"17:49:13.110069  INFO [  reactor-http-nio-2] : .k.h.HelloController : controller : {runId=0132096f-aade-49c7-a345-614da004ba25}\n17:49:13.111007  INFO [  reactor-http-nio-2] : m.s.k.h.HelloService : service returning Thomas : {runId=0132096f-aade-49c7-a345-614da004ba25, name=Thomas}\n"})}),"\n",(0,r.jsx)(e.p,{children:"Or in Seq log aggregator:"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{alt:"Two structured log messages shown in Seq log aggregator",src:o(5480).A+"",width:"869",height:"290"})}),"\n",(0,r.jsx)(e.h2,{id:"gradle-setup",children:"Gradle setup"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://search.maven.org/search?q=g:%22io.klogging%22%20AND%20a:%22klogging-spring-boot-starter%22",children:(0,r.jsx)(e.img,{src:"https://img.shields.io/maven-central/v/io.klogging/klogging-spring-boot-starter.svg?label=maven%20central",alt:"Maven Central"})})}),"\n",(0,r.jsx)(e.admonition,{type:"info",children:(0,r.jsx)(e.p,{children:"Klogging supports Spring Boot versions 3 and later."})}),"\n",(0,r.jsx)(e.p,{children:"Use a Gradle configuration like this:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-kotlin",children:'configurations.all {\n    // Exclude any other libraries from loading Logback.\n    exclude("ch.qos.logback")\n}\n\ndependencies {\n    implementation("org.springframework.boot:spring-boot-starter-actuator")\n    implementation("org.springframework.boot:spring-boot-starter-webflux")\n    implementation("io.klogging:klogging-spring-boot-starter:0.11.3")\n\n    // Other dependencies.\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["Spring uses ",(0,r.jsx)(e.a,{href:"https://www.slf4j.org/",children:"SLF4J"})," for sending logs and\nbundles ",(0,r.jsx)(e.a,{href:"http://logback.qos.ch/",children:"Logback"})," as the default provider. The ",(0,r.jsx)(e.code,{children:"exclude"})," function shown\nhere is needed to exclude Logback from Spring."]}),"\n",(0,r.jsx)(e.h2,{id:"maven-setup",children:"Maven setup"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://search.maven.org/search?q=g:%22io.klogging%22%20AND%20a:%22klogging-spring-boot-starter%22",children:(0,r.jsx)(e.img,{src:"https://img.shields.io/maven-central/v/io.klogging/klogging-spring-boot-starter.svg?label=maven%20central",alt:"Maven Central"})})}),"\n",(0,r.jsx)(e.admonition,{type:"info",children:(0,r.jsx)(e.p,{children:"Version 0.3.0 supports Spring Boot versions 2.x and 3.x."})}),"\n",(0,r.jsx)(e.p,{children:"Something like this:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-xml",children:"\n<dependencies>\n  <dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-actuator</artifactId>\n    <exclusions>\n      <exclusion>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-logging</artifactId>\n      </exclusion>\n    </exclusions>\n  </dependency>\n  <dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-webflux</artifactId>\n    <exclusions>\n      <exclusion>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-logging</artifactId>\n      </exclusion>\n    </exclusions>\n  </dependency>\n  \x3c!-- Other runtime dependencies --\x3e\n\n  <dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-test</artifactId>\n    \x3c!-- This exclusion may not be necessary, unlike the Gradle equivalent. --\x3e\n    <exclusions>\n      <exclusion>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-logging</artifactId>\n      </exclusion>\n    </exclusions>\n  </dependency>\n  \x3c!-- Other test dependencies --\x3e\n</dependencies>\n"})}),"\n",(0,r.jsx)(e.h2,{id:"configure-klogging",children:"Configure Klogging"}),"\n",(0,r.jsxs)(e.p,{children:["Put a ",(0,r.jsx)(e.code,{children:"klogging.json"})," file in the ",(0,r.jsx)(e.code,{children:"src/main/resources"})," directory of the project."]}),"\n",(0,r.jsx)(e.p,{children:"Here is a simple one for logging to the console."}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "sinks": {\n    "stdout": {\n      "renderWith": "RENDER_ANSI",\n      "sendTo": "STDOUT"\n    }\n  },\n  "logging": [\n    {\n      "levelRanges": [\n        {\n          "fromMinLevel": "INFO",\n          "toSinks": [\n            "stdout"\n          ]\n        }\n      ]\n    }\n  ]\n}\n'})})]})}function d(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(c,{...n})}):c(n)}},5480:(n,e,o)=>{o.d(e,{A:()=>i});const i=o.p+"assets/images/spring-boot-klogging-logs-5ed460ef5099cc0e565cd8daf453fa10.png"},8453:(n,e,o)=>{o.d(e,{R:()=>t,x:()=>l});var i=o(6540);const r={},s=i.createContext(r);function t(n){const e=i.useContext(s);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:t(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);